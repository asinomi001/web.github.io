<!DOCTYPE html>
<html><head><meta charset="utf-8"><title>Account</title></head>
<body style="font-family:Arial;padding:24px;">
<script>
const me = JSON.parse(localStorage.getItem('logged_user'));
if(!me){ alert('Please login'); location.href='login.html'; }
</script>

<h2>My Account</h2>
<img id="av" width="100" style="border-radius:50%"><br>
<b>ID:</b> <span id="myid"></span><br>
<b>Username:</b> <span id="myusername"></span><br>
<label>Name:</label><br><input id="myname"><br>
<label>Password:</label><br><input id="mypassword" type="password"><br>
<label>Change avatar:</label><br><input type="file" id="changeAvatar"><br><br>
<button id="save">Save</button>
<button id="logout" style="background:#e74c3c;color:white">Logout</button>

<script>
document.getElementById('av').src = me.avatar || 'images/avatar1.png';
document.getElementById('myid').textContent = me.id;
document.getElementById('myusername').textContent = me.username;
document.getElementById('myname').value = me.name;
document.getElementById('mypassword').value = me.password;

document.getElementById('changeAvatar').addEventListener('change', e=>{
  const f = e.target.files[0]; if(!f) return;
  const r = new FileReader();
  r.onload = ev => { document.getElementById('av').src = ev.target.result; me.avatar = ev.target.result; };
  r.readAsDataURL(f);
});

document.getElementById('save').onclick = ()=>{
  const users = JSON.parse(localStorage.getItem('my_users')||'[]');
  const idx = users.findIndex(u=>u.id===me.id);
  users[idx].name = document.getElementById('myname').value;
  users[idx].password = document.getElementById('mypassword').value;
  users[idx].avatar = document.getElementById('av').src;
  localStorage.setItem('my_users', JSON.stringify(users));
  localStorage.setItem('logged_user', JSON.stringify(users[idx]));
  alert('Saved');
};

document.getElementById('logout').onclick = ()=>{
  localStorage.removeItem('logged_user');
  alert('Logged out');
  location.href='login.html';
};
</script>
</body>
</html>
